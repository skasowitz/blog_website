{
  "hash": "fc2d011cfe7ad3471b0aacbb596af856",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"30DayMapChallenge Day 01 - Points\"\ndescription: \"First look at working with maps in Python\"\ndate: \"2025-11-01\"\nimage: featured.png\nimage-alt: A map of New Zealand featuring regional borders, elevation gradient, and indicating the highest points with dots.\ncategories:\n  - 30DayMapChallenge\n  - Data visualization\n  - Python\n  - Geospatial\ntoc: true\nnumber-sections: true\ncitation: true\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\nexecute:\n  echo: true\n  warning: false\njupyter: python3\n---\n\nThe [#30DayMapChallenge](https://30daymapchallenge.com/) may happen every November, but it still managed to completely sneak up on me. The first day's challenge asks us to create a map with point data, and I decided to \n\n## Setup\n\n::: {#659801f5 .cell execution_count=1}\n``` {.python .cell-code}\nimport json\nimport pandas as pd\nimport geopandas as gpd\nfrom geodatasets import get_path\n\nfrom arcgis.gis import GIS\nfrom arcgis.features import FeatureLayer\n\ngis = GIS()\n```\n:::\n\n\n## Retrieve Data\n\n::: {#5fb47267 .cell execution_count=2}\n``` {.python .cell-code}\npolling_locs = gis.content.get('23a056702cfd40848deef9597945a998')\n```\n:::\n\n\nThis Feature Layer Collection has 5 layers\n\n::: {#dbc2479b .cell execution_count=3}\n``` {.python .cell-code}\nfor feature_layer in polling_locs.layers:\n    print(feature_layer.properties.name)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEarly Voting Polling Sites Non NYC \nEarly Voting Polling Sites NYC \nElection Day Polling Sites Non NYC \nElection Day Polling Sites NYC\nElection Districts\n```\n:::\n:::\n\n\nFor this map I decided to look at the NYC Election Day polling locations. First, retrieve the data with a `query` on the `FeatureLayer`.\n\n::: {#7aa14768 .cell execution_count=4}\n``` {.python .cell-code}\nnyc_election_day_url = 'https://services6.arcgis.com/EbVsqZ18sv1kVJ3k/arcgis/rest/services/NYS_Elections_Districts_and_Polling_Locations/FeatureServer/3'\nnyc_election_day = FeatureLayer(nyc_election_day_url)\npolling_sites = nyc_election_day.query()\npolling_sites\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\n<FeatureSet> 1212 features\n```\n:::\n:::\n\n\nNext, preparing the data for plotting by creating a `geopandas.GeoDataFrame`.\n\n::: {#82b759f4 .cell execution_count=5}\n``` {.python .cell-code}\npolling_sites_gjson = polling_sites.to_geojson\npolling_sites_dict = json.loads(polling_sites_gjson)\npolling_sites_gdf = gpd.GeoDataFrame.from_features(polling_sites_dict['features'])\npolling_sites_gdf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>geometry</th>\n      <th>OBJECTID</th>\n      <th>Poll_Site_Name</th>\n      <th>Poll_Site_Address</th>\n      <th>City</th>\n      <th>ZipCode</th>\n      <th>County</th>\n      <th>NYS_Latitude</th>\n      <th>NYS_Longitude</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>POINT (592646.639 4526000.831)</td>\n      <td>1</td>\n      <td>Ft. Independence Community Center</td>\n      <td>3350 Bailey Avenue</td>\n      <td>Bronx</td>\n      <td>10463</td>\n      <td>Bronx</td>\n      <td>40.879846</td>\n      <td>-73.900400</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>POINT (591752.532 4525907.066)</td>\n      <td>2</td>\n      <td>In Tech High School (MS/HS 368)</td>\n      <td>2975 Tibbett Avenue</td>\n      <td>Bronx</td>\n      <td>10463</td>\n      <td>Bronx</td>\n      <td>40.879102</td>\n      <td>-73.911024</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>POINT (592321.697 4518947.062)</td>\n      <td>3</td>\n      <td>St. Anselm School</td>\n      <td>685 Tinton Avenue</td>\n      <td>Bronx</td>\n      <td>10455</td>\n      <td>Bronx</td>\n      <td>40.816350</td>\n      <td>-73.905302</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>POINT (587021.407 4492206.798)</td>\n      <td>4</td>\n      <td>Neshama Community Services</td>\n      <td>301 Seabreeze Avenue</td>\n      <td>Brooklyn</td>\n      <td>11224</td>\n      <td>Kings</td>\n      <td>40.576073</td>\n      <td>-73.971849</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>POINT (594951.145 4503973.588)</td>\n      <td>5</td>\n      <td>PS IS 667</td>\n      <td>76 Dinsmore Place</td>\n      <td>Brooklyn</td>\n      <td>11208</td>\n      <td>Kings</td>\n      <td>40.681186</td>\n      <td>-73.876401</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Make a Map\n\nLat and Long to point geometry. I couldn't ftell out what coordinate system the NYS data is using, so guessed `EPSG: 4326`. Converted so the data could plot over a map of the NYC boroughs.\n\n::: {#b3a1083b .cell execution_count=6}\n``` {.python .cell-code}\npolling_gdf = gpd.GeoDataFrame(polling_sites_gdf, geometry = gpd.points_from_xy(polling_sites_gdf.NYS_Longitude, polling_sites_gdf.NYS_Latitude), crs=\"EPSG:4326\")\npolling_gdf.head()\n# Convert coordinate system\npolling_gdf = polling_gdf.to_crs('EPSG:2263')\n```\n:::\n\n\n::: {#7c46a107 .cell execution_count=7}\n``` {.python .cell-code}\n# Get borough boundaries\npath_to_data = get_path(\"nybb\")\nnybb_dat = gpd.read_file(path_to_data)\nnybb_dat = nybb_dat.set_index(\"BoroName\")\nnybb_dat[\"boundary\"] = nybb_dat.boundary\n```\n:::\n\n\n::: {#faac48be .cell execution_count=8}\n``` {.python .cell-code}\n# Draw the map\nax = nybb_dat[\"boundary\"].plot()\nax.set_axis_off()\npolling_gdf[\"geometry\"].plot(\n    figsize=(12, 12),\n    ax=ax,\n    color=\"black\",\n    markersize=1\n).set_title(\"NYC Election Day Polling Sites: 2025\")\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\nText(0.5, 1.0, 'NYC Election Day Polling Sites: 2025')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-9-output-2.png){width=392 height=409}\n:::\n:::\n\n\n",
    "supporting": [
      "index_files\\figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}